# We need a special agent here because we need to:
# 1. Expose the admin endpoint
# 2. Allow for an authorized delegate


agent {
    data_dir = "./data/agent"
    log_level = "DEBUG"
    trust_domain = "example.org"
    server_address = "localhost"
    server_port = 8081

    # Insecure bootstrap is NOT appropriate for production use but is ok for 
    # simple testing/evaluation purposes.
    insecure_bootstrap = true

    admin_socket_path = "/tmp/spire-agent/admin/api.sock"
    authorized_delegates = [
      "spiffe://example.org/myservice",
    ]
}

plugins {
   KeyManager "disk" {
        plugin_data {
            directory = "./data/agent"
        }
    }

    NodeAttestor "join_token" {
        plugin_data {}
    }

    WorkloadAttestor "unix" {
        plugin_data {}
    }
}